apply plugin: 'maven-publish'
apply plugin: 'maven'

configurations {
	deployerJars
}

dependencies {
	deployerJars "io.packagecloud.maven.wagon:maven-packagecloud-wagon:0.0.6"
}

private Boolean isValid() {
	if(project.hasProperty('repository_url') && project.hasProperty('auth_password')) return true
	return false
}

uploadArchives {
	// Exemplo de repo url "packagecloud+https://packagecloud.io/Amauri/release"

	if(!isValid()) return

	def libVersion = project.version
	def repositoryURL = project.property('repository_url')
	def authPassword = project.property('auth_password')

	if (!project.hasProperty('release')) {
		libVersion = "${project.version}-SNAPSHOT"
	}

	repositories.mavenDeployer {
		pom.groupId = project.group
		pom.artifactId = project.name
		pom.version = libVersion
		configuration = configurations.deployerJars
		repository(url: repositoryURL) {
			authentication(password: authPassword)
		}
	}
}

